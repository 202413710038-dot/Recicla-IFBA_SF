<script>
const REPO_URL = "https://raw.githubusercontent.com/SEU_USUARIO/Recicla-IFBA-SF/main/Chat%20Bot/dados.json";

let baseConhecimento = {};

async function carregarDados() {
  try {
    const res = await fetch(REPO_URL);
    baseConhecimento = await res.json();
    console.log("Dados carregados com sucesso:", baseConhecimento);
  } catch (err) {
    console.error("Erro ao carregar dados:", err);
  }
}

function addMessage(text, sender) {
  const msg = document.createElement("div");
  msg.classList.add("message", sender);
  msg.innerHTML = text.replace(/\n/g, "<br>");
  document.getElementById("chat-box").appendChild(msg);
  document.getElementById("chat-box").scrollTop = document.getElementById("chat-box").scrollHeight;
}

function responderPergunta(pergunta) {
  pergunta = pergunta.toLowerCase();
  let resposta = "Desculpe, nÃ£o encontrei informaÃ§Ãµes sobre isso ainda.";

  for (const chave in baseConhecimento) {
    if (pergunta.includes(chave.toLowerCase())) {
      resposta = baseConhecimento[chave];
      break;
    }
  }

  return resposta;
}

async function enviarMensagem() {
  const input = document.getElementById("user-input");
  const texto = input.value.trim();
  if (!texto) return;
  addMessage(texto, "user");
  input.value = "";

  addMessage("Analisando sua pergunta...", "bot");
  setTimeout(() => {
    document.querySelector("#chat-box .bot:last-child").remove();
    const resposta = responderPergunta(texto);
    addMessage(resposta, "bot");
  }, 700);
}

document.getElementById("send-btn").onclick = enviarMensagem;
document.getElementById("user-input").addEventListener("keypress", e => {
  if (e.key === "Enter") enviarMensagem();
});

// Mensagem inicial
addMessage("OlÃ¡! ðŸ‘‹ Sou o assistente da Lixeira Inteligente. Pergunte-me sobre montagem, Arduino, servos, cÃ¢mera ou materiais!", "bot");

// Carrega os dados JSON
carregarDados();
</script>
